/*! EnhancedPostMessage 2014-09-14 */
!function(a){var b=!1,c={_defaults:{stringify:!1},_options:{},_events:{},_listeners:{},_sources:{},initialize:function(c){var f=this;if(!b){c.sources||this.log("Must have at least one source available",!0);for(var g in c.sources)c.sources.hasOwnProperty(g)&&this._addSource(g,c.sources[g]);if(c.events&&e(c.events).length)for(var h in c.events)c.events.hasOwnProperty(h)&&this._addEvent(h,c.events[h]);this._options=d({},this._defaults,c),a.addEventListener("message",function(a){f._handleEventListener(a)}),b=!0}},triggerEvent:function(a,b,c){var d=this._sources[a],e=this._events[b];if(!d)return this.log("No source by that name"),!1;if(!e)return this.log("No events by that name"),!1;if(e!==!0)if("function"==typeof e)c=e();else{if("object"!=typeof e)return this.log("Event value was not a valid type"),!1;c=e}var f={eventName:b,data:c};d.contentWindow.postMessage(this._options.stringify?JSON.stringify(f):f,"*")},_addEvent:function(a,b){this._events[a]=b},_addListener:function(a,b){this._listeners[a]=b},_addSource:function(a,b){this._sources[a]=b},_setOptions:function(){},_setOption:function(a,b){this._options[a]=b},_handleEventListener:function(a){this.log(a)}};c.log=function(b,c){b=b instanceof Array?b:[b],a.console&&this._options.debug&&(c?console.error:console.log).apply(console,b)};var d=function(a){for(var b,c,d=1,e=arguments.length;e>d;d++){b=arguments[d];for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])}return a},e=function(a){if(Object.keys)return Object.keys(a);var b=[];for(key in a)a.hasOwnProperty(key)&&b.push(key);return b};a.PluginName=function(a){arguments.length>1?"trigger"===arguments[0]&&arguments.length>=3&&c.triggerEvent(arguments[1],arguments[2],arguments[3]):1==arguments.length&&c.initialize(a)}}(window);